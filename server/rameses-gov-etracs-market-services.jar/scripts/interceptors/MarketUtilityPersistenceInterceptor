import com.rameses.annotations.*;

class MarketUtilityPersistenceInterceptor{
	
	@DataContext("market_account")
	def acctEm;

	
	@After(pattern="PersistenceService.create", eval="#{ args[0]._schemaname == 'market_account_water' }")
	public void updateWater(def evt) {
		def e = evt.args[0];
		acctEm.find( [objid: e.account.objid ]).update( [waterid: e.objid]);
	}

	@After(pattern="PersistenceService.create", eval="#{ args[0]._schemaname == 'market_account_electricity' }")
	public void updateElectiricity(def evt) {
		def e = evt.args[0];
		acctEm.find( [objid: e.account.objid ]).update( [electricity: e.objid]);
	}


}